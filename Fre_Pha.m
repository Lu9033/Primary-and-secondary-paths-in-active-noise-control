%对于有理分式H(jw),MATLAB提供freqs函数处理方法。调用格式为H=freqs(b,a,w)
%其中，b为分子多项式的系数，a为分母多项式系数，w为需计算的频率特性
%函数的取样点数。程序如下(低通滤波器为例)：
clear
clc
clf
close all

%主级通道、次级通道
P_Z = [ -0.237467,0.806502,-1.882598,3.601750, -5.938800, 8.734397, -11.601771, 13.989734, -15.218549, 14.661575, -11.943175, 7.090693, -0.801205, -5.311028, 11.085567, -15.154731, 16.927727, -17.206356, 15.141826, -12.420147, 8.971280, -5.755672, 3.278546, -1.155305, 0.303144];

P_P = [ 1.000000, -2.616971, 5.868128, -10.254027, 16.472815, -23.574261, 31.578068, -39.180908, 46.125938, -51.048965, 53.950325, -54.055084, 51.845238, -47.205044, 41.234455, -34.143761, 27.083752, -20.176018, 14.395070, -9.473912, 5.902801, -3.258903, 1.655440, -0.656055, 0.208196];

S_Z = [ -0.073844, 0.280609, -0.778907, -0.321869, 2.563927, -5.876712, 11.504314, -18.114344, 25.967108, -33.871861, 41.345085, -47.070049, 50.785450, -51.863720, 50.043129, -45.990845, 39.786583, -33.078777, 25.692730, -18.861567, 12.781915, -8.174841, 4.567914, -2.076808, 0.728670];

S_P = [ 1.000000, -2.126286, 4.237403, -6.964616, 10.683328, -14.553812, 18.877407, -22.745882, 26.226549, -28.574720, 29.879738, -29.674311, 28.296484, -25.745836, 22.470392, -18.625055, 14.694556, -10.964108, 7.748295, -4.980707, 2.969857, -1.507602, 0.719325, -0.266916, 0.055631];


fvtool(P_Z,P_P) ;%  fvtool(B,A) launches the Filter Visualization Tool and computes the
% %     Magnitude Response for the filter defined by numerator and denominator
% %     coefficients in vectors B and A.数据给反了
% hold on
% fvtool(S_Z,S_P);

% impz(S_Z,1);

% load Pw.mat
% load Sw.mat
% PP = Pw(1:end);
% SS = Sw(1:end);
% 


% Pw = [0 0 0 1 -0.3 0.2];
% B1 = 1;
% Hz = [1 -0.4 0.3];
% Sv = [1.5 0.2 1 0.5];%虚拟位置路径
% fvtool(Pw,1);
% hold on
% fvtool(Hz,1);%Kz
% hold on
% fvtool(Sv,1);%Kz





